{"version":3,"sources":["components/loggers/logger.js"],"names":["fs","require","path","logger","exports","appDir","dirname","main","filename","access","createWriteStream","flags","error","debugLevel","log","level","message","levels","date","Date","dateStr","getFullYear","pad","getMonth","getDate","getHours","getMinutes","getSeconds","indexOf","write","console","n","width","length","Array","join"],"mappings":"AAAA;;;;AAIA;;;;;;;;AACA,IAAIA,KAAKC,QAAQ,IAAR,CAAT;AACA,IAAIC,OAAOD,QAAQ,MAAR,CAAX;AACA,IAAIE,SAASC,OAAb;AACA,IAAIC,SAASH,KAAKI,OAAL,CAAaL,QAAQM,IAAR,CAAaC,QAA1B,CAAb;AACA,IAAIC,SAAST,GAAGU,iBAAH,CAAqBL,SAAS,kBAA9B,EAAkD,EAACM,OAAO,GAAR,EAAlD,CAAb;AAAA,IACGC,QAAQZ,GAAGU,iBAAH,CAAqBL,SAAS,iBAA9B,EAAiD,EAACM,OAAO,GAAR,EAAjD,CADX;AAEAR,OAAOU,UAAP,GAAoB,MAApB;AACAV,OAAOW,GAAP,GAAa,UAAUC,KAAV,EAAiBC,OAAjB,EAA0B;AACtC,KAAIC,SAAS,CAAC,OAAD,EAAU,MAAV,EAAkB,MAAlB,CAAb;;AAEA,KAAIC,OAAO,IAAIC,IAAJ,EAAX;AACA,KAAIC,UAAU,MAAMF,KAAKG,WAAL,EAAN,GAA2B,GAA3B,GAAiCC,IAAIJ,KAAKK,QAAL,EAAJ,EAAqB,CAArB,CAAjC,GAA2D,GAA3D,GAAiED,IAAIJ,KAAKM,OAAL,EAAJ,EAAoB,CAApB,CAAjE,GAA0F,GAA1F,GAAgGF,IAAIJ,KAAKO,QAAL,EAAJ,EAAqB,CAArB,CAAhG,GAA0H,GAA1H,GAAgIH,IAAIJ,KAAKQ,UAAL,EAAJ,EAAuB,CAAvB,CAAhI,GAA4J,GAA5J,GAAkKJ,IAAIJ,KAAKS,UAAL,EAAJ,EAAuB,CAAvB,CAAlK,GAA8L,GAA5M;;AAEA,KAAI,OAAOX,OAAP,KAAmB,QAAvB,EAAiC;AAChCA,YAAU,yBAAeA,OAAf,CAAV;AACA;;AAED,KAAIC,OAAOW,OAAP,CAAeb,KAAf,KAAyBE,OAAOW,OAAP,CAAezB,OAAOU,UAAtB,CAA7B,EAAgE;AAC/DJ,SAAOoB,KAAP,CAAaT,UAAU,KAAV,GAAkBJ,OAAlB,GAA4B,IAAzC;AACA,EAFD,MAEO;AAAC;AACPJ,QAAMiB,KAAN,CAAYT,UAAU,KAAV,GAAkBJ,OAAlB,GAA4B,IAAxC;AACA;;AAEDc,SAAQhB,GAAR,CAAYC,QAAQ,IAAR,GAAeC,OAA3B;AACA,CAjBD;;AAmBA;AACA,SAASM,GAAT,CAAaS,CAAb,EAAgBC,KAAhB,EAAuB;AACtBD,KAAIA,IAAI,EAAR;AACA,QAAOA,EAAEE,MAAF,IAAYD,KAAZ,GAAoBD,CAApB,GAAwB,IAAIG,KAAJ,CAAUF,QAAQD,EAAEE,MAAV,GAAmB,CAA7B,EAAgCE,IAAhC,CAAqC,GAArC,IAA4CJ,CAA3E;AACA","file":"logger.js","sourcesContent":["/**\r\n * Created by ChanWoo Kwon on 2017-03-17.\r\n * file 및 server console에 로그를 남김\r\n */\r\n'use strict';\r\nvar fs = require('fs');\r\nvar path = require('path');\r\nvar logger = exports;\r\nvar appDir = path.dirname(require.main.filename);\r\nvar access = fs.createWriteStream(appDir + '/node.access.log', {flags: 'a'})\r\n\t, error = fs.createWriteStream(appDir + '/node.error.log', {flags: 'a'});\r\nlogger.debugLevel = 'warn';\r\nlogger.log = function (level, message) {\r\n\tvar levels = ['error', 'warn', 'info'];\r\n\t\r\n\tvar date = new Date();\r\n\tvar dateStr = \"[\" + date.getFullYear() + \"-\" + pad(date.getMonth(), 2) + \"-\" + pad(date.getDate(), 2) + \" \" + pad(date.getHours(), 2) + \":\" + pad(date.getMinutes(), 2) + \":\" + pad(date.getSeconds(), 2) + \"]\";\r\n\t\r\n\tif (typeof message !== 'string') {\r\n\t\tmessage = JSON.stringify(message);\r\n\t}\r\n\t\r\n\tif (levels.indexOf(level) >= levels.indexOf(logger.debugLevel)) {\r\n\t\taccess.write(dateStr + \" - \" + message + \"\\n\");\r\n\t} else {//error\r\n\t\terror.write(dateStr + \" - \" + message + \"\\n\");\r\n\t}\r\n\t\r\n\tconsole.log(level + ': ' + message);\r\n};\r\n\r\n//숫자를 width 자리로 만들어줌 (width = 2, '8' -> '08' | width = 4, '4' -> '0004')\r\nfunction pad(n, width) {\r\n\tn = n + '';\r\n\treturn n.length >= width ? n : new Array(width - n.length + 1).join('0') + n;\r\n}"]}
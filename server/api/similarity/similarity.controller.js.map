{"version":3,"sources":["api/similarity/similarity.controller.js"],"names":["code","content","mongodb","require","properties","SimilarityChecker","similarityChecker","req","res","list","body","db","name","ratio","limitRatio","open","then","collection","findOne","_id","err","doc","json","result","message","readContentFromCode","apiurl","rank","catch","getSimilarityContent"],"mappings":";;;;;QAYgBA,I,GAAAA,I;QAuCAC,O,GAAAA,O;AAnDhB;;;;;;AAMA,IAAIC,UAAUC,QAAQ,gCAAR,CAAd;AACA,IAAIC,aAAaD,QAAQ,0BAAR,CAAjB;;AAEA,IAAIE,oBAAoBF,QAAQ,+CAAR,CAAxB;AACA,IAAIG,oBAAoB,IAAID,iBAAJ,EAAxB;;AAEO,SAASL,IAAT,CAAcO,GAAd,EAAmBC,GAAnB,EAAwB;AAC9B,KAAIC,OAAOF,IAAIG,IAAJ,CAASD,IAApB;AACA,KAAIE,KAAKJ,IAAIG,IAAJ,CAASE,IAAlB;AACA,KAAIC,QAAQN,IAAIG,IAAJ,CAASI,UAArB;;AAEAZ,SAAQa,IAAR,CAAa,YAAb,EAA2B,QAA3B,EAAqC,KAArC,EACCC,IADD,CACM,UAACC,UAAD,EAAgB;AACrBA,aAAWC,OAAX,CAAmB,EAACC,KAAKR,EAAN,EAAnB,EAA8B,UAACS,GAAD,EAAMC,GAAN,EAAc;;AAE3C,OAAID,GAAJ,EAAS;AACR,WAAOZ,IAAIc,IAAJ,CAAS;AACfC,aAAS,MADM;AAEfC,cAASJ,IAAII;AAFE,KAAT,CAAP;AAIA;;AAED,UAAOlB,kBAAkBmB,mBAAlB,CAAsCJ,IAAIK,MAA1C,EAAkDf,EAAlD,EAAsDF,IAAtD,EAA4DI,KAA5D,EACNG,IADM,CACD,UAACW,IAAD,EAAU;AACf,WAAOnB,IAAIc,IAAJ,CAAS;AACfd,UAAKmB;AADU,KAAT,CAAP;AAGA,IALM,EAMNC,KANM,CAMA,UAACR,GAAD,EAAS;AACf,WAAOZ,IAAIc,IAAJ,CAAS;AACfC,aAAS,MADM;AAEfC,cAASJ,IAAII;AAFE,KAAT,CAAP;AAIA,IAXM,CAAP;AAYA,GArBD;AAsBA,EAxBD,EAyBCI,KAzBD,CAyBO,UAACR,GAAD,EAAS;AACf,SAAOZ,IAAIc,IAAJ,CAAS;AACfC,WAAS,MADM;AAEfC,YAASJ,IAAII;AAFE,GAAT,CAAP;AAIA,EA9BD;AAgCA;;AAEM,SAASvB,OAAT,CAAiBM,GAAjB,EAAsBC,GAAtB,EAA2B;AACjC,KAAIC,OAAOF,IAAIG,IAAJ,CAASD,IAApB;AACA,KAAII,QAAQN,IAAIG,IAAJ,CAASI,UAArB;;AAEA,QAAOR,kBAAkBuB,oBAAlB,CAAuCzB,WAAWsB,MAAlD,EAA0DjB,IAA1D,EAAgEI,KAAhE,EACNG,IADM,CACD,UAACR,GAAD,EAAS;AACd,SAAOA,IAAIc,IAAJ,CAAS,EAAT,CAAP;AACA,EAHM,EAINM,KAJM,CAIA,UAACR,GAAD,EAAS;AACf,SAAOZ,IAAIc,IAAJ,CAAS;AACfC,WAAS,MADM;AAEfC,YAAShB,IAAIgB;AAFE,GAAT,CAAP;AAIA,EATM,CAAP;AAUA","file":"similarity.controller.js","sourcesContent":["/**\r\n *\r\n * @author ChanWoo Kwon\r\n * date : 2018-05-08\r\n */\r\n\r\nlet mongodb = require('../../components/commons/mongo');\r\nlet properties = require('../../config/environment');\r\n\r\nlet SimilarityChecker = require('../../components/similarity/SimilarityChecker');\r\nlet similarityChecker = new SimilarityChecker();\r\n\r\nexport function code(req, res) {\r\n\tlet list = req.body.list;\r\n\tlet db = req.body.name;\r\n\tlet ratio = req.body.limitRatio;\r\n\t\r\n\tmongodb.open('similarity', 'coredb', false)\r\n\t.then((collection) => {\r\n\t\tcollection.findOne({_id: db}, (err, doc) => {\r\n\t\t\t\r\n\t\t\tif (err) {\r\n\t\t\t\treturn res.json({\r\n\t\t\t\t\tresult:  'fail',\r\n\t\t\t\t\tmessage: err.message\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\treturn similarityChecker.readContentFromCode(doc.apiurl, db, list, ratio)\r\n\t\t\t.then((rank) => {\r\n\t\t\t\treturn res.json({\r\n\t\t\t\t\tres: rank\r\n\t\t\t\t});\r\n\t\t\t})\r\n\t\t\t.catch((err) => {\r\n\t\t\t\treturn res.json({\r\n\t\t\t\t\tresult:  'fail',\r\n\t\t\t\t\tmessage: err.message\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t});\r\n\t})\r\n\t.catch((err) => {\r\n\t\treturn res.json({\r\n\t\t\tresult:  'fail',\r\n\t\t\tmessage: err.message\r\n\t\t});\r\n\t});\r\n\t\r\n}\r\n\r\nexport function content(req, res) {\r\n\tlet list = req.body.list;\r\n\tlet ratio = req.body.limitRatio;\r\n\t\r\n\treturn similarityChecker.getSimilarityContent(properties.apiurl, list, ratio)\r\n\t.then((res) => {\r\n\t\treturn res.json({});\r\n\t})\r\n\t.catch((err) => {\r\n\t\treturn res.json({\r\n\t\t\tresult:  'fail',\r\n\t\t\tmessage: res.message\r\n\t\t});\r\n\t});\r\n}"]}